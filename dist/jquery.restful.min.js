/*!
 * jQuery restful plugin 0.1
 * https://github.com/myspace-nu
 *
 * Copyright 2018 Johan Johansson
 * Released under the MIT license
 */
!function(t){t.fn.serializeObject=function(){var e={},a=this.serializeArray();return t.each(a,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},t.fn.restful=function(e){var a=t.extend({url:null,method:"POST",onComplete:function(){},onSuccess:function(){},onError:function(){},dataType:"json",defaultValue:null},e);a.url&&(a.url=a.url.replace(/\/+$/,"")),this.each(function(){"form"==this.tagName.toLowerCase()?t(this).submit(function(e){e.preventDefault();var n=t(this).serializeObject(),r=t(this).attr("action");!r.match(/^(\w{3,5}\:)?\/+/)&&a.url&&(r=a.url+"/"+r.replace(/^\/+/,""));var o=r.match(/{+\:?\w+}+/g);for(var s in o){var i=o[s].match(/\w+/);r=r.replace(o[s],n[i[0]]||n[i[0].toLowerCase()]||a.defaultValue),delete n[i[0]]}var c={url:r,type:t(this).attr("method")||a.method,context:this,success:function(t){a.onSuccess.call(this,t)},error:function(t){a.onError.call(this,t)},complete:function(t){a.onComplete.call(this,t)}};"get"==c.type.toLowerCase()?c.url+="?"+t.param(n):"json"==a.dataType.toLowerCase()?(c.contentType="application/json; charset=utf-8",c.dataType="json",c.data=JSON.stringify(n)):c.data=n,t.ajax(c)}):t(this).click(function(e){e.preventDefault();var n=t(this).data(),r=t(this).attr("href");!r.match(/^(\w{3,5}\:)?\/+/)&&a.url&&(r=a.url+"/"+r.replace(/^\/+/,""));var o=r.match(/{+\:?\w+}+/g);for(var s in o){var i=o[s].match(/\w+/);r=r.replace(o[s],n[i[0]]||n[i[0].toLowerCase()]||a.defaultValue),delete n[i[0].toLowerCase()]}var c={url:r,type:a.method,context:this,success:function(t){a.onSuccess.call(this,t)},error:function(t){a.onError.call(this,t)},complete:function(t){a.onComplete.call(this,t)}};"get"==c.type.toLowerCase()?c.url+="?"+t.param(n):"json"==a.dataType.toLowerCase()?(c.contentType="application/json; charset=utf-8",c.dataType="json",c.data=JSON.stringify(n)):c.data=n,t.ajax(c)})})},t.restful=function(e){t.fn.restful(e)}}(jQuery);