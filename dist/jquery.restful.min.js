/*!
 * jQuery restful plugin v1.1.4
 * https://github.com/myspace-nu
 *
 * Copyright 2018 Johan Johansson
 * Released under the MIT license
 */

!function(c){c.fn.serializeObject=function(){var e={},t=this.serializeArray();return c.each(t,function(){e[this.name]?(e[this.name].push||(e[this.name]=[e[this.name]]),e[this.name].push(this.value||"")):e[this.name]=this.value||""}),e},c.fn.restful=function(e){var l=c.extend({url:null,method:"POST",onComplete:function(){},onSuccess:function(){},onError:function(){},onBeforeRequest:function(){},dataType:"json",preventHammering:!0,defaultValue:null},e);l.url&&(l.url=l.url.replace(/\/+$/,"")),this.each(function(){"form"==this.tagName.toLowerCase()?c(this).submit(function(e){e.preventDefault(),l.onBeforeRequest.call(this);var t=c(e.target).find("input[type=submit]:focus,button:focus");l.preventHammering&&c(t).prop("disabled",!0);var a=c(this).serializeObject(),n=c(this).attr("action");n||console.warn("No URL found for "+this.tagName+"-element."),!n.match(/^(\w{3,5}\:)?\/+/)&&l.url&&(n=l.url+"/"+n.replace(/^\/+/,""));var r=n.match(/{+\:?\w+}+/g);for(var o in r){var s=r[o].match(/\w+/);n=n.replace(r[o],a[s[0]]||a[s[0].toLowerCase()]||l.defaultValue),delete a[s[0]]}var i={url:n,type:c(this).attr("method")||l.method,context:this,success:function(e){l.onSuccess.call(this,e)},error:function(e){l.onError.call(this,e)},complete:function(e){l.preventHammering&&c(t).prop("disabled",!1),l.onComplete.call(this,e)}};"get"==i.type.toLowerCase()?i.url+="?"+c.param(a):"json"==l.dataType.toLowerCase()?(i.contentType="application/json; charset=utf-8",i.dataType="json",i.data=JSON.stringify(a)):i.data=a,c.ajax(i)}):c(this).click(function(e){e.preventDefault(),l.onBeforeRequest.call(this);var t=this;if(l.preventHammering){if(c(t).hasClass("disabled"))return;c(t).addClass("disabled")}var a=c(this).data(),n=c(this).attr("href");n||console.warn("No URL found for "+t.tagName+"-element."),!n.match(/^(\w{3,5}\:)?\/+/)&&l.url&&(n=l.url+"/"+n.replace(/^\/+/,""));var r=n.match(/{+\:?\w+}+/g);for(var o in r){var s=r[o].match(/\w+/);n=n.replace(r[o],a[s[0]]||a[s[0].toLowerCase()]||l.defaultValue),delete a[s[0].toLowerCase()]}var i={url:n,type:l.method,context:this,success:function(e){l.onSuccess.call(this,e)},error:function(e){l.onError.call(this,e)},complete:function(e){l.preventHammering&&c(t).removeClass("disabled"),l.onComplete.call(this,e)}};"get"==i.type.toLowerCase()?i.url+="?"+c.param(a):"json"==l.dataType.toLowerCase()?(i.contentType="application/json; charset=utf-8",i.dataType="json",i.data=JSON.stringify(a)):i.data=a,c.ajax(i)})})}}(jQuery);